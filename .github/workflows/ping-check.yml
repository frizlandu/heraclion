name: V√©rification /ping Heraclion

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  ping-check:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout du code
      uses: actions/checkout@v3

    - name: D√©marrer le backend (si applicable)
      run: |
        npm install
        npm run start &
        sleep 10 # Attendre que le serveur d√©marre

    - name: V√©rifier /ping
      run: |
        echo "üîç Test de la route /ping..."
        response=$(curl -s http://localhost:3000/ping)
        echo "R√©ponse: $response"
        success=$(echo $response | jq -r '.success')
        if [ "$success" != "true" ]; then
          echo "‚ùå La route /ping ne r√©pond pas correctement."
          exit 1
        fi
        echo "‚úÖ /ping op√©rationnel."
